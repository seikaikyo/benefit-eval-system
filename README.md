# WISE-IoT SRP 維護服務效益評估系統 V2.1.7

[![Deploy Status](https://img.shields.io/badge/deploy-automated-brightgreen)](https://benefit-eval-system.vercel.app/)
[![Version](https://img.shields.io/badge/version-2.1.7-blue)](#版本歷程)
[![React](https://img.shields.io/badge/React-18+-61dafb)](https://reactjs.org/)
[![Vite](https://img.shields.io/badge/Vite-5+-646cff)](https://vitejs.dev/)
[![CoreUI](https://img.shields.io/badge/CoreUI-5.7+-blue)](https://coreui.io/)

> 🎯 **智能報價系統**: 專為 WISE-IoT SRP 維護服務設計的成本效益評估與報價生成平台

## 📋 系統概述

WISE-IoT SRP 維護服務效益評估系統是一個專業的報價生成平台，幫助業務團隊快速評估客戶的維護服務需求，並生成專業的報價文件。系統整合了台灣公司統編查詢、智能成本分析、動態服務配置等功能，提供完整的報價解決方案。

### 🌟 核心特色

- **🎨 現代化 UI**: 採用 CoreUI 5.7+ 企業級設計系統，專業美觀的管理介面
- **🔍 智能統編查詢**: 自動查詢台灣公司統編，快速填入公司基本資訊
- **🏭 班別風險分析**: 根據不同生產班別自動調整風險係數和成本評估
- **⚙️ 動態服務配置**: 支援拖拽排序、方案複製與彈性編輯，直觀管理服務項目
- **📊 即時成本分析**: 智能計算停機損失、投資回報期與風險評估
- **🧭 導航錨點系統**: 一鍵快速定位到各個編輯區域，支援完整操作手冊
- **📄 智能分析報價**: PDF包含完整班別風險分析、停機損失計算與投資回報評估
- **📧 現代化溝通**: Email聯絡方式，適應現代商務需求
- **🖱️ 拖拽功能**: 直觀的拖拽操作，輕鬆調整服務方案排序

## 🚀 系統功能

### 1. 公司資訊管理
- **統編查詢**: 支援台灣公司統編 API 查詢，自動填入公司資訊
- **基本資訊**: 公司名稱、地址、聯絡人、電話等
- **營收數據**: 年營業額設定，用於成本效益計算

### 2. 生產模式配置
- **8小時制**: 標準工作時間，風險係數 1.0
- **12小時制**: 輪班作業，風險係數 1.3  
- **24小時制**: 連續生產，風險係數 1.8

### 3. 服務項目管理
#### 平台與應用層服務
- **Basic MA**: 基礎監控與警報
- **Premium MA**: 進階分析與預測維護
- **Advanced MA**: 完整智能維護解決方案

#### 硬體基礎服務  
- **Basic HA**: 基礎硬體監控
- **Premium HA**: 完整硬體維護
- **Advanced HA**: 智能硬體管理

### 4. 智能分析引擎
- **停機成本計算**: 依據營業額與班別風險自動計算
- **投資回報分析**: ROI 計算與建議
- **服務適用性評估**: 智能推薦最適合的服務方案

### 5. 專業報價匯出
- **智能PDF報價書**: A4 格式專業報價，包含完整風險分析、停機損失計算、投資回報評估
- **Excel分析表**: 詳細數據表格，包含Email聯絡資訊，便於內部評估與客戶溝通

## 🛠️ 技術架構

### 前端技術棧
- **React 18+**: 現代化前端框架
- **CoreUI 5.7+**: 企業級 Bootstrap 設計系統
- **CoreUI Icons**: 專業圖標字體庫，取代 emoji 提升專業度
- **Vite 5+**: 高性能構建工具
- **ES6+ JavaScript**: 現代 JavaScript 語法
- **CSS3**: 響應式設計與動畫效果

### API 整合
- **Vercel Serverless**: API 代理解決 CORS 問題
- **台灣公司統編查詢**: OpenData VIP & G0V API
- **jsPDF**: PDF 生成與匯出
- **SheetJS**: Excel 文件處理

### 部署平台
- **Vercel**: 自動化部署與 CDN 加速
- **GitHub**: 版本控制與持續整合
- **Speed Insights**: Vercel 性能監控與分析

## 📱 使用指南

### 快速開始
1. **統編查詢**: 輸入 8 位統編號碼（如：22099131）
2. **選擇班別**: 根據實際生產模式選擇適當班別
3. **配置服務**: 調整服務項目與價格
4. **查看分析**: 檢視成本效益分析結果
5. **匯出報價**: 選擇 PDF 或 Excel 格式匯出

### 導航功能
系統左側提供快速導航功能：
- 🏢 **公司資訊**: 統編查詢與基本資料
- 🏭 **生產班別**: 選擇生產模式  
- 📝 **特殊需求**: 填寫客製化需求
- ⚙️ **服務配置**: 調整服務方案與價格
- 📊 **方案比較**: 查看詳細對照表
- 💰 **成本分析**: 檢視停機風險評估
- 📄 **匯出報價**: 生成PDF或Excel報價書

### 測試統編
系統支援以下測試統編：
- `22099131`: 台灣積體電路製造股份有限公司
- `22356500`: 研華股份有限公司  
- `23526740`: 鴻海精密工業股份有限公司

## 🛡️ 安全性說明

### 已知安全問題
- **xlsx@0.18.5**: 存在原型污染和ReDoS漏洞
- **風險評估**: 低風險（僅客戶端使用，無伺服器端處理）
- **減緩措施**: 僅用於Excel匯出功能，不處理外部輸入文件
- **監控狀態**: 持續關注安全更新，考慮替代方案

## 🔧 本地開發

### 環境需求
- Node.js 18+
- npm 或 yarn

### 安裝與啟動
```bash
# 複製專案
git clone <repository-url>
cd benefit-evaluation-analysis

# 安裝依賴
npm install

# 啟動開發服務器
npm run dev

# 構建生產版本
npm run build
```

### 專案結構
```
src/
├── components/          # React 組件
│   ├── ConfigPanel.jsx        # 配置面板（支援拖拽排序）
│   ├── ServiceConfigCard.jsx  # CoreUI 服務配置卡片組件
│   ├── ComparisonTable.jsx    # 比較表格
│   ├── ExportButtons.jsx      # 匯出功能
│   ├── TaxIdLookup.jsx        # 統編查詢
│   ├── UserGuide.jsx          # CoreUI 導航指南
│   └── PDFQuote.jsx           # PDF報價模板
├── utils/              # 工具函式
│   └── taxIdService.js        # 統編查詢服務
└── App.jsx             # 主應用程式（CoreUI 管理介面）

api/
└── taxid.js            # Vercel API 代理
```

## 📈 版本歷程

### V2.1.7 (2025-08-14) - CoreUI 企業級 UI 設計系統完整導入
**🎨 重大 UI 升級**:
- 🚀 **CoreUI 5.7+ 導入**: 完整採用 CoreUI React 企業級設計系統
- 🖼️ **圖標字體升級**: 使用 CoreUI Icons 取代所有 emoji，提升專業度
- 🖱️ **拖拽功能**: 實現服務方案拖拽排序，支援方案複製與刪除
- 🎛️ **管理介面**: 專業的左側導航 + 主內容區域布局
- 📋 **組件化重構**: 創建 ServiceConfigCard 組件，提升代碼可維護性

**💡 用戶體驗改進**:
- 🔧 **輸入框修復**: 解決拖拽元素中輸入框無法編輯的問題
- 📝 **方案名稱編輯**: 方案名稱移至「啟用此方案」下方，邏輯更清晰
- 🎯 **字段順序優化**: 統一為「方案名稱 → 產品編號 → 服務標題 → 價格」
- 🌙 **主題簡化**: 移除日夜模式切換，維持乾淨的亮色專業主題
- 🧭 **導航優化**: 左側導航文字與圖標使用白色，提升可讀性

**🛠️ 技術改進**:
- 新增 @coreui/react, @coreui/icons, @coreui/icons-react 依賴
- 完整重構 App.jsx 為管理介面布局
- 創建專業的服務配置卡片組件
- 優化 CSS 支援 CoreUI 組件系統
- 修復所有拖拽相關的交互問題

### V2.1.6 (2025-08-14) - 界面優化與輸入修復
**🔧 關鍵修復**:
- 修復方案名稱輸入框無法編輯問題
- 優化服務配置界面排版
- 加強輸入框可編輯性支援

### V2.1.5 (2025-08-14) - 計算邏輯硬編碼問題修正與性能監控
**🔧 關鍵修正**:
- 🐛 **硬編碼計算修正**: 修正ComparisonTable.jsx中未使用共用計算函數的問題
- 🔄 **動態計算**: 確保班別變更時所有計算（停機風險、回本時間）正確更新
- 📊 **計算統一性**: 統一使用calculateRevenue.downtimeRisk和breakEvenHours函數
- ⚡ **性能監控**: 整合Vercel Speed Insights，提供即時性能分析
- 🎯 **數值格式化**: 修正顯示格式不一致問題
- 🛡️ **安全性說明**: 說明xlsx已知安全問題及風險評估

**🚀 技術改進**:
- 新增@vercel/speed-insights依賴包
- 完全消除計算邏輯中的硬編碼問題
- 確保所有組件使用統一的計算函數庫
- 版本號更新至V2.1.5

**🛡️ 安全性說明**:
- xlsx@0.18.5存在已知安全漏洞(原型污染、ReDoS)
- 當前使用情境風險低：僅用於客戶端Excel匯出
- 無更新版本可修復，已評估風險可接受

### V2.1.4 (2025-08-14) - 全面數值計算修正與PDF分頁優化
**🎯 重大修正**:
- 🔢 **計算精度全面修正**: 修正所有時營業額、停機損失與投資回報計算
- 📄 **PDF分頁結構優化**: 實現理想三頁結構（平台服務→硬體服務→風險分析）
- 💰 **單位一致性**: 統一萬元顯示單位，消除數值錯誤
- 🛠️ **breakEvenHours修正**: 修正投資回本時間計算邏輯

**📊 計算邏輯改進**:
- 時營業額: 150000萬 → 17.1萬/小時 (正確)
- 停機損失: 考慮風險係數的精確計算
- 投資回本: serviceCost / (hourlyRevenue * 10000) 正確換算
- 風險係數: 統一使用1.0x格式（非100%）

**📄 PDF結構優化**:
- 第1頁: 平台與應用層服務對照表
- 第2頁: 硬體基礎層服務對照表
- 第3頁: 班別風險分析與成本效益評估

### V2.1.3 (2025-08-14) - 時營業額計算單位修正

### V2.1.2 (2025-08-14) - 風險係數顯示格式統一

### V2.1.1 (2025-08-14) - 計算邏輯統一與PDF匯出優化  
**🎯 高優先級修正**:
- 🔧 **計算邏輯統一**: 創建共用計算函數，修正三個組件間數值不一致問題
- 📐 **數值精度改善**: 統一使用Math.round()四捨五入方式，確保計算準確性  
- 📄 **PDF生成優化**: 改善html2canvas設定，提升PDF品質和響應式支援
- 🛡️ **錯誤處理強化**: 詳細的錯誤訊息，改善使用者體驗與問題診斷
- 📁 **檔名安全性**: 修正特殊字元處理，確保所有平台相容性

**🔍 技術改進**:
- 新增`calculateRevenue`共用函數庫（日/時營業額、停機風險、回本計算）
- 統一`formatPrice`和`getCombinedPrice`函數使用
- 優化PDF等待機制，動態檢測DOM元素載入完成
- 提升Canvas生成品質(scale: devicePixelRatio, quality: 0.95)

### V2.1 (2025-08-13) - 完整智能分析PDF與用戶體驗優化  
**🎯 主要更新**:
- 📄 **PDF智能分析**: 完全重構PDF報價書，包含班別風險分析、停機損失計算、投資回報評估
- 📧 **聯絡方式現代化**: 將傳真欄位全面改為Email，適應現代商務溝通
- 📖 **操作手冊恢復**: 在導航錨點基礎上恢復完整操作手冊內容
- 🧭 **導航優化**: 快速導航預設為展開狀態，提升用戶體驗
- 🌐 **頁面標題**: 修正瀏覽器標題為正確的系統名稱

**📊 PDF報價書增強**:
- 🏭 班別風險係數智能分析（8小時/12小時/24小時制）
- ⚠️ 停機損失精確計算（2小時/4小時情境）
- 💰 風險調整後的投資回報分析
- 📈 專業級商業決策支援文件

**🎨 用戶體驗改進**:
- 清理統編示例文字，使介面更簡潔專業
- 導航面板預設展開，立即可見所有功能
- 保留完整操作手冊，支援詳細使用指導

### V2.0 (2025-08-13) - 智能導航與CORS解決方案
**🎯 主要更新**:
- ✨ **導航錨點系統**: 左側面板改為互動式快速定位導航
- 🔧 **CORS問題解決**: 實作Vercel API代理，完全解決統編查詢CORS限制  
- 🗑️ **代碼優化**: 移除本地端統編查詢，完全依賴線上API服務
- 🎨 **用戶體驗**: 平滑滾動與視覺反饋效果

**🚀 技術改進**:
- 新增 `/api/taxid.js` Vercel Serverless Function
- 重構 `UserGuide.jsx` 為導航錨點系統
- 優化 `taxIdService.js` API查詢邏輯
- 新增所有關鍵區域的錨點ID支援

### V1.8 (2025-08-13) - 班別風險分析強化
- 🏭 **智能班別分析**: 完善生產班別風險係數計算
- 📊 **成本分析優化**: 改善停機損失與投資回報計算邏輯
- 🎨 **UI/UX改善**: 優化版面配置與使用者互動體驗

### V1.5 - 服務比較系統
- 📋 **動態服務對照**: 實作智能服務功能比較表
- 💰 **價格計算引擎**: 完善服務價格與成本分析
- 📄 **匯出功能**: PDF與Excel雙格式報價書生成

### V1.0 - 基礎系統
- 🏢 **統編查詢**: 基礎台灣公司統編查詢功能
- ⚙️ **服務配置**: 平台與硬體服務項目管理
- 📊 **報價生成**: 基礎報價單生成功能

## 🌐 線上展示

**正式網站**: [https://benefit-eval-system.vercel.app/](https://benefit-eval-system.vercel.app/)

## 🤝 開發團隊

- **主要開發**: WISE-IoT Team
- **技術支援**: Claude AI Assistant
- **部署平台**: Vercel
- **版本控制**: GitHub

## 📞 支援與回饋

如有任何問題或建議，請透過以下方式聯繫：
- 📧 Email: [聯絡信箱]
- 🐛 Issue Tracking: GitHub Issues
- 💬 即時支援: [支援管道]

---

<div align="center">

**🤖 Generated with [Claude Code](https://claude.ai/code)**

*Last Updated: 2025-08-14 - V2.1.7 CoreUI Complete Redesign*

</div>